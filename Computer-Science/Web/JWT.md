# JWT

- JWT(JSON Web Token)는 웹에서 인증과 권한 부여를 위한 방식 중 하나로, 서버와 클라이언트 간에 신뢰할 수 있는 정보를 안전하게 전송하기 위해 사용됨. 
- 특히 무상태(stateless) 인증 시스템을 구현할 때 많이 사용됨.


### 🔐 JWT란?
- JWT는 JSON 객체를 사용해서 정보를 안전하게 전송하기 위한 토큰 포맷. 
- 기본적으로 세 부분으로 구성된 문자열

#### ✅ 구조 (3가지 파트)
- JWT는 .(dot)으로 구분된 세 부분으로 구성됩니다:
```text
<Header>.<Payload>.<Signature>
```
- 예시
```text
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
.
eyJ1c2VySWQiOiIxMjM0NTYifQ
.
SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```
| 부분          | 설명                                                            |
|---------------|-----------------------------------------------------------------|
| **Header**    | 토큰의 타입(JWT)과 서명 알고리즘(예: HS256) 정보                |
| **Payload**   | 실제 정보(클레임, 예: userId, 권한 등)가 담기는 부분            |
| **Signature** | 비밀 키를 사용해서 Header와 Payload를 서명한 것. 위조 방지 목적 |


### 📥 JWT 발급 과정 (로그인 시 예시)
1. 클라이언트가 로그인 정보를 보냄 (ex. ID, Password)
2. 서버가 인증을 처리하고, 해당 유저 정보를 기반으로 JWT를 생성하여 클라이언트에 전달
3. 클라이언트는 JWT를 로컬 저장소(localStorage)나 쿠키에 저장함


### 🔁 인증 과정 (요청 시)
- 클라이언트가 API 요청을 보낼 때, JWT를 Authorization 헤더에 포함
```http
Authorization: Bearer <JWT_TOKEN>
```
- 서버는 JWT의 서명을 검증하고, 유효하면 해당 사용자로 간주하여 요청을 처리


### 🧾 JWT의 장점
| 장점               | 설명                                                           |
|--------------------|----------------------------------------------------------------|
| **무상태**         | 서버가 세션을 저장할 필요 없이 JWT만으로 인증 가능             |
| **확장성**         | 인증 처리 분산 서버 구조에서도 활용 가능                       |
| **자체 정보 포함** | 토큰 안에 필요한 정보를 포함하므로, 별도 조회 없이 처리가 가능 |


### ⚠️ 주의사항
- JWT는 저장소에 노출되면 탈취 위험이 있음 → XSS 방지 필수
- 변경/폐기 불가: 발급된 JWT는 만료되기 전까지 유효 (중간 폐기 어려움)
- Refresh Token을 함께 사용해 Access Token의 짧은 수명을 보완하는 방식 권장


### 🆚 JWT vs Session
| 항목                       | JWT 방식                                  | 세션 방식                                      |
|----------------------------|-------------------------------------------|------------------------------------------------|
| **상태 유지**              | 무상태 (Stateless)                        | 유상태 (Stateful)                              |
| **저장 위치 (서버)**       | 저장 없음                                 | 서버 메모리 또는 데이터베이스에 저장           |
| **저장 위치 (클라이언트)** | Access Token은 보통 localStorage/cookie   | 세션 ID는 보통 쿠키(cookie)에 저장             |
| **확장성**                 | 높음 (분산 서버 구조에 유리)              | 낮음 (세션이 중앙 서버에 저장되므로 부하 증가) |
| **토큰 정보**              | 유저 정보가 자체 포함 (클레임 기반)       | 별도 저장소(서버)에 유저 정보 저장             |
| **위변조 방지**            | 서명(signature)으로 토큰 무결성 확인 가능 | 서버에서만 관리하므로 위변조 위험 낮음         |
| **로그아웃 처리**          | 어렵다 (토큰 자체는 만료되기 전까지 유효) | 쉬움 (서버에서 세션 삭제)                      |
| **만료 관리**              | 토큰에 만료 시간 포함                     | 서버에서 직접 제어 가능                        |
| **보안 이슈**              | 탈취 시 위험 → HTTPS, XSS 방지 필요       | 서버 관리이므로 클라이언트 탈취 위험 적음      |

- JWT는 REST API나 모바일 앱 등에서 분산 시스템에 적합하며, 서버 부담이 적습니다.
- 세션은 보안에 강하고 로그아웃 제어가 쉬우며, 상대적으로 단일 서버 환경에 적합합니다.
