# 웹 브라우저에서 웹페이지가 표시되기까지 과정

```text
[브라우저] → URL 입력
    ↓
[DNS] → IP 주소 획득
    ↓
[TCP/TLS] → 서버와 연결
    ↓
[HTTP 요청] → HTML/CSS/JS 요청
    ↓
[서버] → 요청 처리 및 응답
    ↓
[HTTP 응답] → 브라우저 수신
    ↓
[렌더링 파이프라인] → DOM + CSSOM → Layout → Paint → 화면 출력
    ↓
[추가 요청] → 이미지/JS 등 로딩
    ↓
[사용자와 상호작용]
```

### 1. 사용자가 URL을 브라우저에 입력

### 2. 브라우저가 URL을 파싱
> 브라우저가 입력된 주소(URL)를 분석해서 어떤 자원(resource)을 어디서 어떻게 가져올지를 결정하는 작업

- 예시 URL: https://www.example.com:443/path/page.html?q=chatgpt#section1

| 구성 요소      | 값                    | 의미                                          |
|----------------|-----------------------|-----------------------------------------------|
| 프로토콜       | https                 | 어떤 방식으로 통신할지 (HTTP, HTTPS 등)       |
| 호스트명       | www.example.com       | 서버 주소 (도메인)                            |
| 포트 번호      | 443 (생략 가능)       | 통신에 사용하는 포트 (HTTPS 기본값은 443)     |
| 경로           | /path/page.html       | 요청할 자원의 위치                            |
| 쿼리 스트링    | ?q=chatgpt            | 검색어나 필터 같은 추가 정보                  |
| 프래그먼트     | #section1             | 문서 내 특정 위치 (스크롤용, 서버에 안 보냄)  |

### 3. DNS 조회 (도메인 이름 -> IP주소)
- 브라우저는 도메인을 **IP 주소로 변환**해야 서버에 연결할 수 있음.
#### 과정
1. 브라우저 캐시 확인 
  - 브라우저는 최근 방문한 도메인의 IP 주소를 자체적으로 임시 저장해 둠.
  - 시간 제한(TTL)에 따라 만료됨
2. 운영체제 캐시 확인
  - 브라우저 캐시에 없다면, OS에 저장된 DNS 캐시를 확인.
  - OS 수준에서 메모리에 기록되어 있어 응답 속도가 빠름.
3. **로컬 DNS 서버(예: 통신사 DNS) 요청
  - 운영체제에 캐시가 없으면 네트워크 설정에 등록된 DNS 서버로 질의
    - 예: SK, KT, LG 등 통신사의 DNS 서버
    - 또는 Google DNS (8.8.8.8), Cloudflare DNS (1.1.1.1)
  - 이 서버는 캐시를 가지고 있을 수도 있고, 없다면 상위 DNS 서버에 질의를 보냄.
4. DNS루트 서버 (보통 ISP에서 제공) ->
  - 전 세계에 약 13개의 루트 DNS 서버가 존재 (A~M 루트 서버)
  - .루트 영역을 담당하고, 다음 단계인 TLD 서버를 알려줌.
5. TLD 서버(Top Level Domain 서버) ->
  - .com, .net, .org, .kr, .jp 같은 도메인의 최상위 도메인(.com 등)을 관리.
  - example.com 요청 시, .com TLD 서버는 example.com의 권한 있는 DNS 서버 주소를 응답.
6. 권한 있는(authoritative) DNS 서버 -> 순으로 탐색
  - 도메인 등록 시 설정한 네임서버가 해당 도메인의 IP 주소를 최종적으로 알고 있음.
  - 이 서버가 www.example.com의 진짜 IP 주소를 알려줌.

### 4. TCP 연결 설정 (3-way Handshake)
브라우저(클라이언트)는 서버와 통신하기 위해 **TCP연결**을 만듬.
  - (TCP는 신뢰성 있는 통신을 보장하는 프로토콜)

1. 클라이언트 -> 서버 : SYN
2. 서버 -> 클라이언트 : SYN-ACK
3. 클라이언트 -> 서버 : ACK

- HTTPS인 경우 : 연결 후 TLS 핸드세이크를 통해 암호화 설정 수행

### 5. HTTP 요청전송(Request)
브라우저는 웹페이지를 요청하기 위해 HTTP 요청을 보냄.

### 6. 서버에서 요청 처리
- 경로(/)에 해당하는 **파일(ex. index.html)**이나 **동적 컨텐츠(PHP, Nojde.js 등)** 생성
- 요청을 인증해야 하는 경우 **세션/토큰 검사**
- 요청에 맞는 데이터를 **DB에서 조회**
- HTML 또는 JSON 등의 응답 생성

### 7. 서버 -> 브라우저로 HTTP 응답 전송(Response)
- 서버는 결과를 **HTTP 응답**으로 클라이언트에 보냅니다.
- 상태 코드 200 OK는 정상 응답.
- Content-Type에 따라 브라우저가 응답을 해석

### 8. 브라우저가 HTML 파싱 시작 (렌더랑 파이프라인)
- 브라우저는 받은 HTML을 기반으로 화면에 웹페이지를 렌더링합니다.

### 9. 추가 리소스 요청
- HTML 내 `<img>`, `<script>`, `<link>` 등 외부 리소스는 별도로 요청함.
- 병렬적으로 여러 HTTP 요청을 보냄.
- JS 파일은 다운로드 후 실행되고, DOM을 조작하기도 함. (ex SPA)

### 10. 사용자와 상호작용
- 웹페이지가 렌더링된 후 사용자는 마우스 클릭, 키보드 입력 등을 통해 상호작용 가능
  - 이벤트 핸들러(예: addEventListener)가 작동하며 JS 코드 실행됨
